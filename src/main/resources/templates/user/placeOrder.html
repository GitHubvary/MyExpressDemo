<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>下单-快递代拿系统</title>
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}" href="../../static/layui/css/layui.css" media="all">
    <link rel="stylesheet" th:href="@{/css/public.css}" href="../../static/css/public.css" media="all">
</head>
<body>
<div class="layuimini-container">
    <div class="layuimini-main">
        <h2 style="margin-left: 70px;">填写订单信息</h2>
        <hr>
        <form class="layui-form layuimini-form" action="/user/toPay" method="post">
            <div class="layui-form-item">
                <label class="layui-form-label">收件人姓名</label>
                <div class="layui-col-md3">
                    <input type="text" id="inputName" name="recName" required lay-verify="required|username" placeholder="请输入收件人姓名" autocomplete="off"
                           class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">联系人手机号</label>
                <div class="layui-col-md3">
                    <input type="text" id="inputTel" name="recTel"  required lay-verify="required|phone" placeholder="请输入手机号" autocomplete="off"
                           class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">取货码</label>
                <div class="layui-col-md3">
                    <input type="text" id="inputOdd" name="odd" required lay-verify="required" placeholder="请输入取货码" autocomplete="off"
                           class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">快递公司</label>
                <div class="layui-col-md3">
                    <select name="company" id="inputCompany">
                        <option value="">--请选择快递公司--</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">快递取件地址</label>
                <div class="layui-col-md5">
                    <input type="text" id="inputAddress" name="address" required lay-verify="required" placeholder="此地址为配送员的取件地址" autocomplete="off"
                           class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">收件地址</label>
                <div class="layui-col-md5">
                    <input type="text" id="inputRecAddress" name="recAddress" required lay-verify="required" placeholder="此地址为配送员送达的目的地址" autocomplete="off"
                           class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">备注（可选）</label>
                <div class="layui-col-md5">
                    <input type="text" id="inputRemark" name="remark"  placeholder="如果有特殊要求，请备注于此" autocomplete="off"
                           class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                </div>
            </div>
            <hr>

            <div class="layui-form-item " style="margin-left: 110px">
                <div class="layui-form-label">
                    <button lay-submit lay-filter="toPay" class="layui-btn" id="payBtn" onClick="storage()">前往支付</button>
                </div>
                <div class="layui-form-label">
                    <button type="reset" class="layui-btn  layui-btn-danger">重新填写</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script th:src="@{/js/jquery-3.4.1/jquery-3.4.1.min.js}" src="../../static/js/jquery-3.4.1/jquery-3.4.1.min.js" charset="utf-8" type="text/javascript"></script>
<script th:src="@{/layui/layui.js}" src="../../static/layui/layui.js" charset="utf-8"></script>
<script th:src="@{/js/lay-config.js}" src="../../static/js/lay-config.js?v=1.0.4" charset="utf-8"></script>
<script th:src="@{/js/http.js}" src="../../static/js/http.js"></script>
<script  type="text/javascript" th:inline="javascript">
    layui.use(['form','layer'], function(){
        var form = layui.form;
        var $ = layui.$;
        var layer = layui.layer;

        form.verify({
            username: function(value, item){ //value：表单的值、item：表单的DOM对象
                if(!new RegExp("^[\u4e00-\u9fa5\]+$").test(value)){
                    return '姓名只能是中文';
                }
            }
        });

        // 加载快递公司数据
        sendJson(HTTP.GET, "/company", null, false, function (res) {
            if (res.code === 0) {
                let html = '', data = res.data;
                for(let i = 0; i<data.length; i++) {
                    html += '<option value="'+data[i].id+'">'+data[i].name+ '</option>\n';
                }
                $("#inputCompany").append(html);
                form.render();
            } else {
                layer.msg(res.msg, {icon: 2});
            }
        }, function () {
            layer.msg("未知错误", {icon: 2});
        });

        $(document).ready(function () {
            var name = sessionStorage.getItem("name");
            var tel = sessionStorage.getItem("tel");
            var odd = sessionStorage.getItem("odd");
            var company= sessionStorage.getItem("company");
            var address = sessionStorage.getItem("address");
            var recAddress = sessionStorage.getItem("recAddress");
            var remark = sessionStorage.getItem("remark");


            $('#inputName').val(name);
            $('#inputTel').val(tel);
            $('#inputOdd').val(odd);
            $('#inputAddress').val(address);
            $('#inputRecAddress').val(recAddress);
            $('#inputRemark').val(remark);
            $('#inputCompany').val(company);
            form.render('select');
            sessionStorage.clear();
        });



        window.storage = function () {
            sessionStorage.clear();
            var name = $('#inputName').val();
            var tel = $('#inputTel').val();
            var odd = $('#inputOdd').val();
            var company= $('#inputCompany option:selected').val();
            var address = $('#inputAddress').val();
            var recAddress = $('#inputRecAddress').val();
            var remark = $('#inputRemark').val();

            sessionStorage.setItem("name",name);
            sessionStorage.setItem("tel",tel);
            sessionStorage.setItem("odd",odd);
            sessionStorage.setItem("company",company);
            sessionStorage.setItem("address",address);
            sessionStorage.setItem("recAddress",recAddress);
            sessionStorage.setItem("remark",remark);
        }


    })
</script>
</body>
</html>