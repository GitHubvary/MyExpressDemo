<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>账号信息完善-快递代拿系统</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="icon" th:href="@{/images/favicon.ico}" href="../static/images/favicon.ico">
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}" href="../static/layui/css/layui.css" media="all" type="text/css">
    <link rel="stylesheet" th:href="@{/css/completeInfo.css}" href="../static/css/completeInfo.css" media="all" type="text/css">
    <script th:src="@{/layui/layui.js}" src="../static/layui/layui.js"  type="text/javascript"></script>
</head>
<body class="container layui-container">

      <h3 class="title">请选择要申请的账号类型</h3>

      <div class="main layui-bg-gray">
          <div  class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">

              <ul class="layui-tab-title">
                  <li class="layui-this">普通用户</li>
                  <li>配送员</li>
              </ul>

              <div class="layui-tab-content">
                  <!--普通用户信息填写-->
                  <div class="layui-tab-item layui-show">
                      <form class="layui-form" id="userInfoForm">
                          <!--学校名称-->
                          <input type="hidden" name="role" value="1">
                          <div class="layui-form-item">
                              <label class="layadmin-user-login-icon layui-icon layui-icon-location"  style="z-index: 1;"></label>
                              <select name="schoolName" lay-verify="required" >
                                  <option value="">请选择所在学校</option>
                                  <option value="华南理工大学广州学院">华南理工大学广州学院</option>
                              </select>
                          </div>
                          <div class="layui-form-item">
                              <label class="layadmin-user-login-icon layui-icon layui-icon-cellphone"></label>
                              <input type="text" name="tel" required lay-verify="required|phone" placeholder="请输入手机号" autocomplete="off"
                                     class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                          </div>
                          <div class="layui-input-inline">
                              <!--不写type="button"不会跳转-->
                              <button type="button" lay-submit lay-filter="userInfo" class="layui-btn">提交</button>
                          </div>
                      </form>
                  </div>
                  <!--配送员信息填写-->
                  <div class="layui-tab-item">
                      <form class="layui-form" id="courierInfoForm">
                          <!--学校名称-->
                          <input type="hidden" name="role" value="2">
                          <div class="layui-form-item">
                              <label class="layadmin-user-login-icon layui-icon layui-icon-location"  style="z-index: 1;"></label>
                              <select name="schoolName" lay-verify="required" >
                                  <option value="">请选择所在学校</option>
                                  <option value="华南理工大学广州学院">华南理工大学广州学院</option>
                              </select>
                          </div>
                          <div class="layui-form-item">
                              <label class="layadmin-user-login-icon layui-icon layui-icon-username"></label>
                              <input type="text" name="realName" required lay-verify="required|username" placeholder="请输入真实姓名" autocomplete="off"
                                     class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                          </div>
                          <div class="layui-form-item">
                              <label class="layadmin-user-login-icon layui-icon layui-icon-user"></label>
                              <input type="text" name="studentId" required lay-verify="required" placeholder="请输入学号" autocomplete="off"
                                     class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                          </div>
                          <div class="layui-form-item">
                              <label class="layadmin-user-login-icon layui-icon layui-icon-auz"></label>
                              <input type="text" name="idCard" required lay-verify="required|identity" placeholder="请输入身份证号" autocomplete="off"
                                     class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                          </div>
                          <div class="layui-form-item">
                              <label class="layadmin-user-login-icon layui-icon layui-icon-cellphone"></label>
                              <input type="text" name="tel" required lay-verify="required|phone" placeholder="请输入手机号" autocomplete="off"
                                     class="layui-input" onkeyup="this.value=this.value.replace(/\s+/g,'')">
                          </div>
                          <div class="layui-input-inline">
                              <button type="button" lay-submit lay-filter="courierInfo" class="layui-btn">提交</button>
                          </div>
                      </form>
                  </div>
              </div>
          </div>
          <hr/>
          <div class="pull-right">
              <a href="/logout"><i class="layui-icon layui-icon-return"></i>返回登录</a>
          </div>
      </div>


      <script th:src="@{/js/http.js}" src="../static/js/http.js"></script>
      <script th:src="@{/js/jquery-3.4.1/jquery-3.4.1.min.js}" src="../static/js/jquery-3.4.1/jquery-3.4.1.min.js" charset="utf-8" type="text/javascript"></script>
      <script th:src="@{/layui/layui.all.js}" src="../static/layui/layui.all.js" charset="utf-8" type="text/javascript"></script>
      <script type="text/javascript">
          //注意：选项卡 依赖 element 模块，否则无法进行功能性操作
          layui.use(['form','layer','element'], function(){
              var element = layui.element;
              var form = layui.form;
              var $ = layui.$;
              var layer = layui.layer;

              form.verify({
                  username: function(value, item){ //value：表单的值、item：表单的DOM对象
                      if(!new RegExp("^[\u4e00-\u9fa5\]+$").test(value)){
                          return '姓名只能是中文';
                      }
                  }
              });

              form.on('submit(userInfo)',function () {
                  sendJson(HTTP.POST, "/user/completeInfo", $("#userInfoForm").serialize() , false, function (res) {
                      if (res.code === 0) {
                          layer.msg("普通用户申请成功！即将重新登录!", {icon: 1},2000);
                          window.setTimeout("window.location.href = '/login';", 3000);
                      }
                  }, function () {
                      layer.msg("信息有误，提交失败", {icon: 2});
                  });
              });

              form.on('submit(courierInfo)',function () {
                  sendJson(HTTP.POST, "/user/completeInfo", $("#courierInfoForm").serialize() , false, function (res) {
                      if (res.code === 0) {
                          layer.msg("配送员申请成功！即将重新登录!", {icon: 1},2000);
                          window.setTimeout("window.location.href = '/logout';", 3000);
                      }
                  }, function () {
                      layer.msg("信息有误，提交失败", {icon: 2});
                  });
              });

          });
      </script>
</body>
</html>