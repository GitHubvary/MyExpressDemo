<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>立即反馈-快递代拿系统<</title>
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}" href="../../static/layui/css/layui.css" media="all">
    <link rel="stylesheet" th:href="@{/css/public.css}" href="../../static/css/public.css" media="all">
</head>
<body>
<div class="layuimini-container">
    <div class="layuimini-main">
        <h2 style="margin-left: 80px;">填写反馈信息</h2>
        <hr>
        <form class="layui-form layuimini-form" id="feedbackForm">
            <div class="layui-form-item">
                <label class="layui-form-label">反馈类型</label>
                <div class="layui-col-md2">
                    <select  name="type" id="inputType">
                        <option value="1">订单反馈</option>
                        <option value="2">意见反馈</option>
                        <option value="3">BUG反馈</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">订单号</label>
                <div class="layui-col-md3">
                    <input type="text" id="inputOrderId" name="orderId" lay-verify="orderNum" placeholder="如反馈内容与订单有关，请填写订单号" autocomplete="off"
                           class="layui-input" onkeyup="value=value.replace(/^(0+)|[^\d.]+/g,'')">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">反馈内容</label>
                <div class="layui-col-md3">
                    <textarea id="inputContent" name="content" required lay-verify="required" placeholder="请输入反馈的内容，如果牵扯到订单，请说明订单号" autocomplete="off"
                              class="layui-textarea" onkeyup="this.value=this.value.replace(/\s+/g,'')"></textarea>
                </div>
            </div>
            <hr>

            <div class="layui-form-item " style="margin-left: 110px">
                <div class="layui-form-label">
                    <button type="button" lay-submit lay-filter="subFeedback" class="layui-btn">提交反馈</button>
                </div>
                <div class="layui-form-label">
                    <button type="reset" class="layui-btn  layui-btn-danger">重新填写</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script th:src="@{/js/jquery-3.4.1/jquery-3.4.1.min.js}" src="../../static/js/jquery-3.4.1/jquery-3.4.1.min.js" charset="utf-8" type="text/javascript"></script>
<script th:src="@{/layui/layui.js}" src="../../static/layui/layui.js" charset="utf-8"></script>
<script th:src="@{/js/lay-config.js}" src="../../static/js/lay-config.js?v=1.0.4" charset="utf-8"></script>
<script th:src="@{/js/http.js}" src="../../static/js/http.js"></script>
<script  type="text/javascript" th:inline="javascript">
    layui.use(['form','layer'], function(){
        var form = layui.form;
        var $ = layui.$;
        var layer = layui.layer;

        form.verify({
            orderNum: function () {
                    if ($("#inputType").val() == "1" && $("#inputOrderId").val() == ""){
                        return "订单反馈必须填写订单号";
                    }
            }
        });

       form.on('submit(subFeedback)',function () {
           layer.confirm("即将提交反馈，确认执行？", {
               btn: ['确定', '取消']
           },function () {
               sendJson(HTTP.POST, "/feedback", $("#feedbackForm").serialize(), false, function (res) {
                   if (res.code !== 0) {
                       layer.msg(res.msg,{icon:2});
                   } else {
                       layer.msg("反馈成功！", {icon: 1});
                       // 重置表单
                       $("#feedbackForm")[0].reset();
                   }
               }, function () {
                   layer.msg("未知错误",{icon:2});
               }, function () {
               });
           })
       })


    })
</script>
</body>
</html>